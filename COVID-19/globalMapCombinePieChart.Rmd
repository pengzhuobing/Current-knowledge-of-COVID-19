---
  title: "Global COVID-19"
output:
  html_notebook:
  code_fold: hide

---
  
```{r setup,include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

# Load fucntions
library(dplyr)
library(optmatch)
library(REmap)
library(data.table)
windowsFonts(A=windowsFont("Times New Roman"))
windowsFonts(A=windowsFont("微软雅黑"))
dat <- read.csv("C:/Users/32601/Desktop/covid-19_plot/20200821.csv",header = T) #每百万人死亡率
dat$MRate <- as.numeric(gsub(",","", dat$Deaths))
dat$color <- as.numeric(cut(dat$MRate, c(0, 0.1, 1, 10, 100,1000,10000)))
dat$region <- dat$锘緾ountry
dat$region <- dat$Country
color <- c("#EFEDF5","#DADAEB","#BCBDDC","#8c88b5","#665d9c","#4a2180") #设置地图颜色
leg.txt <- c(">0.01",">0.1",">1","10",">100",">1000")
```

##add gtInfo
```{r}
#gtinfo <- read.table("C:/Users/32601/Desktop/covid-19_plot/gt6_1.txt",sep="\t")
gtinfo <- read.table("C:/Users/32601/Desktop/covid-19_plot/gt20200818.txt",sep="\t")
chinact<-c("Anhui", "Beijing", "Fujian", "Fuyang", "Guangdong", "Hangzhou", "Hefei", "Hong Kong", "Jiangsu", "Jiangxi", "Jingzhou", "Jiujiang", "Lishui", "Nanchang", "Shandong", "Shanghai", "Shenzhen", "Sichuan", "Taiwan", "Wuhan", "Wuhan-Hu-1", "Xinyu", "Yunnan", "Zhejiang","Xinyu","Tianmen","Shangrao","NanChang","Lishui","Jiujiang","Jingzhou","Jiangxi","Harbin")

for (i in 1:dim(gtinfo)[1]){
  if (gtinfo[i,1]%in%chinact){
    #print(gtinfo[i,1])
    gtinfo[i,1] <- "China"
  }
}

inct<-c("Australia","Brazil","China","Denmark","England","Finland","Germany","Russia","Sweden","USA","India")
sinfo <- gtinfo%>%filter(V1%in%inct)
#sinfo.matrix <- dcast(sinfo,V1~V2) 
sinfo.matrix <- dcast(sinfo,V1~V2,value.var="V3", fun.aggregate = sum)
sinfo.matrix$total <- sinfo.matrix$G+ sinfo.matrix$GH+sinfo.matrix$GR+sinfo.matrix$L+sinfo.matrix$O+sinfo.matrix$S+sinfo.matrix$V
sinfo.matrix$radius <- (sinfo.matrix$total^(1/8))*2+2.4
sinfo.matrix$long <- c(133,-55,110,9,-20,39,0,77,110,28,-100) #设置饼图位置，这里要手动调试，(Australia Brazil China, *Denmark   *England   *Finland   *Germany   ***India Russia    *Sweden    USA)
sinfo.matrix$lat <- c(-24,-10,32,70,47,78,62,20,58,85, 39)

sinfo.matrix$long <- c(133,-55,110,40,68,85,100,77,110,130,-100) #设置饼图位置，这里要手动调试，注意UK
sinfo.matrix$lat <- c(-24,-10,32,100,100,100,100,20,60,100,39)

#sinfo.matrix$long <- c(0,15,30,45,60,85,100,115,130,155) #设置饼图位置，这里要手动调试，注意UK
#sinfo.matrix$lat <- c(100,100,100,100,100,100,100,100,100,100)

```
